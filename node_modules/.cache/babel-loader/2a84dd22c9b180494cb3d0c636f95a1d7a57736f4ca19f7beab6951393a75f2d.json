{"ast":null,"code":"import React,{useState,useEffect}from'react';import{Modal,Button}from'react-bootstrap';import{fetchNews,deleteNews}from'../../http/newsAPI';// Импорт функции fetchNews\nimport EditNewsModal from'./EditNewsModal';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const NewsList=_ref=>{let{show,onHide}=_ref;const[newsList,setNewsList]=useState([]);const[selectedNews,setSelectedNews]=useState(null);const[showEditModal,setShowEditModal]=useState(false);const[currentPage,setCurrentPage]=useState(1);const[totalPages,setTotalPages]=useState(0);useEffect(()=>{if(show){fetchNewsForPage(currentPage);}},[show,currentPage]);const fetchNewsForPage=async page=>{const data=await fetchNews(page);setNewsList(data.rows);setTotalPages(Math.ceil(data.count/3));};const handleDelete=async id=>{await deleteNews(id);setNewsList(newsList.filter(news=>news.id!==id));};const handleEdit=news=>{setSelectedNews(news);setShowEditModal(true);};const handleCloseEditModal=()=>{setShowEditModal(false);};const handleNextPage=()=>{if(currentPage<totalPages){setCurrentPage(currentPage+1);}};const handlePrevPage=()=>{if(currentPage>1){setCurrentPage(currentPage-1);}};return/*#__PURE__*/_jsxs(Modal,{show:show,onHide:onHide,size:\"lg\",centered:true,children:[/*#__PURE__*/_jsx(Modal.Header,{closeButton:true,children:/*#__PURE__*/_jsx(Modal.Title,{children:\"\\u0421\\u043F\\u0438\\u0441\\u043E\\u043A \\u043D\\u043E\\u0432\\u043E\\u0441\\u0442\\u0435\\u0439\"})}),/*#__PURE__*/_jsxs(Modal.Body,{children:[newsList.map(news=>/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h2\",{children:news.name}),/*#__PURE__*/_jsx(Button,{variant:\"danger\",onClick:()=>handleDelete(news.id),children:\"\\u0423\\u0434\\u0430\\u043B\\u0438\\u0442\\u044C\"}),/*#__PURE__*/_jsx(Button,{variant:\"primary\",onClick:()=>handleEdit(news),children:\"\\u0420\\u0435\\u0434\\u0430\\u043A\\u0442\\u0438\\u0440\\u043E\\u0432\\u0430\\u0442\\u044C\"})]},news.id)),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(Button,{onClick:handlePrevPage,disabled:currentPage===1,children:\"\\u041F\\u0440\\u0435\\u0434\\u044B\\u0434\\u0443\\u0449\\u0430\\u044F \\u0441\\u0442\\u0440\\u0430\\u043D\\u0438\\u0446\\u0430\"}),/*#__PURE__*/_jsxs(\"span\",{children:[\" \\u0421\\u0442\\u0440\\u0430\\u043D\\u0438\\u0446\\u0430 \",currentPage,\" \\u0438\\u0437 \",totalPages]}),/*#__PURE__*/_jsx(Button,{onClick:handleNextPage,disabled:currentPage===totalPages,children:\"\\u0421\\u043B\\u0435\\u0434\\u0443\\u044E\\u0449\\u0430\\u044F \\u0441\\u0442\\u0440\\u0430\\u043D\\u0438\\u0446\\u0430\"})]})]}),/*#__PURE__*/_jsx(Modal.Footer,{children:/*#__PURE__*/_jsx(Button,{variant:\"secondary\",onClick:onHide,children:\"\\u0417\\u0430\\u043A\\u0440\\u044B\\u0442\\u044C\"})}),/*#__PURE__*/_jsx(EditNewsModal,{show:showEditModal,onHide:handleCloseEditModal,news:selectedNews})]});};export default NewsList;","map":{"version":3,"names":["React","useState","useEffect","Modal","Button","fetchNews","deleteNews","EditNewsModal","jsx","_jsx","jsxs","_jsxs","NewsList","_ref","show","onHide","newsList","setNewsList","selectedNews","setSelectedNews","showEditModal","setShowEditModal","currentPage","setCurrentPage","totalPages","setTotalPages","fetchNewsForPage","page","data","rows","Math","ceil","count","handleDelete","id","filter","news","handleEdit","handleCloseEditModal","handleNextPage","handlePrevPage","size","centered","children","Header","closeButton","Title","Body","map","name","variant","onClick","disabled","Footer"],"sources":["D:/Psych-narc/client/src/components/modals/NewsList.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport { Modal, Button } from 'react-bootstrap';\r\nimport { fetchNews, deleteNews } from '../../http/newsAPI'; // Импорт функции fetchNews\r\nimport EditNewsModal from './EditNewsModal';\r\n\r\nconst NewsList = ({ show, onHide }) => {\r\n  const [newsList, setNewsList] = useState([]);\r\n  const [selectedNews, setSelectedNews] = useState(null);\r\n  const [showEditModal, setShowEditModal] = useState(false);\r\n  const [currentPage, setCurrentPage] = useState(1);\r\n  const [totalPages, setTotalPages] = useState(0);\r\n\r\n  useEffect(() => {\r\n    if (show) {\r\n      fetchNewsForPage(currentPage);\r\n    }\r\n  }, [show, currentPage]);\r\n\r\n  const fetchNewsForPage = async (page) => {\r\n    const data = await fetchNews(page);\r\n    setNewsList(data.rows);\r\n    setTotalPages(Math.ceil(data.count / 3)); \r\n  };\r\n\r\n  const handleDelete = async (id) => {\r\n    await deleteNews(id);\r\n    setNewsList(newsList.filter((news) => news.id !== id));\r\n  };\r\n\r\n  const handleEdit = (news) => {\r\n    setSelectedNews(news);\r\n    setShowEditModal(true);\r\n  };\r\n\r\n  const handleCloseEditModal = () => {\r\n    setShowEditModal(false);\r\n  };\r\n\r\n  const handleNextPage = () => {\r\n    if (currentPage < totalPages) {\r\n      setCurrentPage(currentPage + 1);\r\n    }\r\n  };\r\n\r\n  const handlePrevPage = () => {\r\n    if (currentPage > 1) {\r\n      setCurrentPage(currentPage - 1);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <Modal show={show} onHide={onHide} size=\"lg\" centered>\r\n      <Modal.Header closeButton>\r\n        <Modal.Title>Список новостей</Modal.Title>\r\n      </Modal.Header>\r\n      <Modal.Body>\r\n        {newsList.map((news) => (\r\n          <div key={news.id}>\r\n            <h2>{news.name}</h2>\r\n            <Button variant=\"danger\" onClick={() => handleDelete(news.id)}>\r\n              Удалить\r\n            </Button>\r\n            <Button variant=\"primary\" onClick={() => handleEdit(news)}>\r\n              Редактировать\r\n            </Button>\r\n          </div>\r\n        ))}\r\n        <div>\r\n          <Button onClick={handlePrevPage} disabled={currentPage === 1}>\r\n            Предыдущая страница\r\n          </Button>\r\n          <span> Страница {currentPage} из {totalPages}</span>\r\n          <Button onClick={handleNextPage} disabled={currentPage === totalPages}>\r\n            Следующая страница\r\n          </Button>\r\n        </div>\r\n      </Modal.Body>\r\n      <Modal.Footer>\r\n        <Button variant=\"secondary\" onClick={onHide}>\r\n          Закрыть\r\n        </Button>\r\n      </Modal.Footer>\r\n      <EditNewsModal\r\n        show={showEditModal}\r\n        onHide={handleCloseEditModal}\r\n        news={selectedNews}\r\n      />\r\n    </Modal>\r\n  );\r\n};\r\n\r\nexport default NewsList;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}