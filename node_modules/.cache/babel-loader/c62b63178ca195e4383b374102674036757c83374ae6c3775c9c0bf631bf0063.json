{"ast":null,"code":"import React,{useEffect,useContext}from'react';import{Container,Row,Col,Card,Button,Pagination}from'react-bootstrap';import{Context}from'../index';import{observer}from'mobx-react-lite';import{fetchDocument,fetchOneDocument}from'../http/documentsAPI';import Docs from'../assets/Docs.svg';import axios from'axios';import fileDownload from'js-file-download';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const Documents=observer(()=>{const{documents}=useContext(Context);const pages=[];useEffect(()=>{fetchDocument(documents.page,documents.limit).then(data=>{documents.setDocs(data.rows);documents.setTotalCount(data.count);});},[documents.page,documents.limit]);const totalPages=Math.ceil(documents.totalCount/documents.limit);for(let i=0;i<totalPages;i++){pages.push(i+1);}const handlePageChange=pageNumber=>{documents.setPage(pageNumber);};const downloadDocument=async id=>{try{const documentData=await fetchOneDocument(id);const response=await axios.get(\"http://localhost:5000/api/documents/\".concat(id),{responseType:'blob'});const contentDisposition=response.headers['content-disposition'];const contentType=response.headers['content-type'];const filename=contentDisposition?contentDisposition.split('filename=')[1]:'document';// Определяем расширение файла на основе contentType\nlet fileExtension;if(contentType==='application/vnd.openxmlformats-officedocument.wordprocessingml.document'){fileExtension='docx';}else if(contentType==='application/pdf'){fileExtension='pdf';}else{console.error('Unsupported file type');return;}fileDownload(response.data,\"\".concat(filename,\".\").concat(fileExtension));}catch(error){console.error('Error downloading document:',error);}};return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(Container,{className:\"block-Standart mt-4\",children:[/*#__PURE__*/_jsx(Pagination,{style:{marginRight:'20px',marginTop:'105px'},children:/*#__PURE__*/_jsx(Pagination.Prev,{disabled:documents.page===1,onClick:()=>handlePageChange(documents.page-1)})}),/*#__PURE__*/_jsx(Row,{className:\"mt-5 block-Standart\",style:{width:'100vw'},children:documents.docs.map((docsItem,index)=>/*#__PURE__*/_jsx(Col,{className:\"g-5 col-md-4 col-lg-4 col-xs-1\",children:/*#__PURE__*/_jsxs(Card,{className:\"card-Docs\",style:{display:'flex',border:'none'},children:[/*#__PURE__*/_jsx(Card.Img,{variant:\"left\",src:Docs,alt:\"\\u0414\\u043E\\u043A\\u0443\\u043C\\u0435\\u043D\\u0442\",style:{paddingBottom:'15px',paddingTop:'15px',paddingLeft:'20px'}}),/*#__PURE__*/_jsxs(Card.Body,{style:{width:'100%'},children:[/*#__PURE__*/_jsx(\"div\",{className:\"body-Bold name-doc\",style:{color:'white',cursor:'pointer'},onClick:()=>downloadDocument(docsItem.id),children:docsItem.name}),/*#__PURE__*/_jsx(\"div\",{className:\"body-Small-Text\",style:{color:'white'},children:docsItem.text})]})]})},index))}),/*#__PURE__*/_jsx(Pagination,{style:{marginLeft:'20px',marginTop:'105px'},children:/*#__PURE__*/_jsx(Pagination.Next,{disabled:documents.page===totalPages,onClick:()=>handlePageChange(documents.page+1)})})]}),/*#__PURE__*/_jsx(Pagination,{className:\"mt-5 block-Standart\",children:/*#__PURE__*/_jsx(\"div\",{className:\"block-Standart\",children:pages.map(page=>/*#__PURE__*/_jsx(Pagination.Item,{active:documents.page===page,onClick:()=>documents.setPage(page),children:page},page))})})]});});export default Documents;","map":{"version":3,"names":["React","useEffect","useContext","Container","Row","Col","Card","Button","Pagination","Context","observer","fetchDocument","fetchOneDocument","Docs","axios","fileDownload","jsx","_jsx","jsxs","_jsxs","Documents","documents","pages","page","limit","then","data","setDocs","rows","setTotalCount","count","totalPages","Math","ceil","totalCount","i","push","handlePageChange","pageNumber","setPage","downloadDocument","id","documentData","response","get","concat","responseType","contentDisposition","headers","contentType","filename","split","fileExtension","console","error","children","className","style","marginRight","marginTop","Prev","disabled","onClick","width","docs","map","docsItem","index","display","border","Img","variant","src","alt","paddingBottom","paddingTop","paddingLeft","Body","color","cursor","name","text","marginLeft","Next","Item","active"],"sources":["D:/Psych-narc/client/src/components/Documents.js"],"sourcesContent":["import React, { useEffect, useContext } from 'react';\r\nimport { Container, Row, Col, Card, Button, Pagination } from 'react-bootstrap';\r\nimport { Context } from '../index';\r\nimport { observer } from 'mobx-react-lite';\r\nimport { fetchDocument, fetchOneDocument } from '../http/documentsAPI';\r\nimport Docs from '../assets/Docs.svg';\r\nimport axios from 'axios';\r\nimport fileDownload from 'js-file-download';\r\n\r\nconst Documents = observer(() => {\r\n  const { documents } = useContext(Context);\r\n  const pages = [];\r\n\r\n  useEffect(() => {\r\n    fetchDocument(documents.page, documents.limit).then(data => {\r\n      documents.setDocs(data.rows);\r\n      documents.setTotalCount(data.count);\r\n    });\r\n  }, [documents.page, documents.limit]);\r\n\r\n  const totalPages = Math.ceil(documents.totalCount / documents.limit);\r\n\r\n  for (let i = 0; i < totalPages; i++) {\r\n    pages.push(i + 1);\r\n  }\r\n\r\n  const handlePageChange = (pageNumber) => {\r\n    documents.setPage(pageNumber);\r\n  };\r\n\r\n  const downloadDocument = async (id) => {\r\n    try {\r\n      const documentData = await fetchOneDocument(id);\r\n      const response = await axios.get(`http://localhost:5000/api/documents/${id}`, {\r\n        responseType: 'blob',\r\n      });\r\n      const contentDisposition = response.headers['content-disposition'];\r\n      const contentType = response.headers['content-type'];\r\n      const filename = contentDisposition ? contentDisposition.split('filename=')[1] : 'document';\r\n\r\n      // Определяем расширение файла на основе contentType\r\n      let fileExtension;\r\n      if (contentType === 'application/vnd.openxmlformats-officedocument.wordprocessingml.document') {\r\n        fileExtension = 'docx';\r\n      } else if (contentType === 'application/pdf') {\r\n        fileExtension = 'pdf';\r\n      } else {\r\n        console.error('Unsupported file type');\r\n        return;\r\n      }\r\n\r\n      fileDownload(response.data, `${filename}.${fileExtension}`);\r\n    } catch (error) {\r\n      console.error('Error downloading document:', error);\r\n    }\r\n  };\r\n\r\n\r\n  return (\r\n    <div>\r\n      <Container className='block-Standart mt-4'>\r\n        <Pagination style={{ marginRight: '20px', marginTop: '105px' }}>\r\n          <Pagination.Prev\r\n            disabled={documents.page === 1}\r\n            onClick={() => handlePageChange(documents.page - 1)}\r\n          />\r\n        </Pagination>\r\n        <Row className=\"mt-5 block-Standart\" style={{ width:'100vw'}}>\r\n          {documents.docs.map((docsItem, index) => (\r\n            <Col key={index} className='g-5 col-md-4 col-lg-4 col-xs-1'>\r\n              <Card className='card-Docs' style={{ display: 'flex', border: 'none' }}>\r\n                <Card.Img\r\n                  variant='left'\r\n                  src={Docs}\r\n                  alt='Документ'\r\n                  style={{ paddingBottom: '15px', paddingTop: '15px', paddingLeft: '20px' }}\r\n                />\r\n                <Card.Body style={{ width: '100%' }}>\r\n                  <div\r\n                    className='body-Bold name-doc'\r\n                    style={{ color: 'white', cursor: 'pointer'}}\r\n                    onClick={() => downloadDocument(docsItem.id)}\r\n                  >\r\n                    {docsItem.name}\r\n                  </div>\r\n                  <div className='body-Small-Text' style={{ color: 'white' }}>\r\n                    {docsItem.text}\r\n                  </div>\r\n                </Card.Body>\r\n              </Card>\r\n            </Col>\r\n          ))}\r\n        </Row>\r\n        <Pagination style={{ marginLeft: '20px', marginTop: '105px' }}>\r\n          <Pagination.Next\r\n            disabled={documents.page === totalPages}\r\n            onClick={() => handlePageChange(documents.page + 1)}\r\n          />\r\n        </Pagination>\r\n      </Container>\r\n      <Pagination className='mt-5 block-Standart'>\r\n        <div className='block-Standart'>\r\n          {pages.map(page => (\r\n            <Pagination.Item\r\n              key={page}\r\n              active={documents.page === page}\r\n              onClick={() => documents.setPage(page)}\r\n            >\r\n              {page}\r\n            </Pagination.Item>\r\n          ))}\r\n        </div>\r\n      </Pagination>\r\n    </div>\r\n  );\r\n});\r\n\r\nexport default Documents;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}